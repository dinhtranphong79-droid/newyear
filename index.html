<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Happy New Year 2026</title>
<style>
  html, body { margin:0; padding:0; background:black; overflow:hidden; }
  canvas { display:block; width:100%; height:100%; }
</style>
</head>
<body>

<canvas id="c"></canvas>

<script>
const canvas = document.getElementById("c");
const ctx = canvas.getContext("2d");

let W,H;
function resize(){ W=canvas.width=window.innerWidth; H=canvas.height=window.innerHeight; }
resize();
window.addEventListener("resize", resize);

const rand = (a,b)=>Math.random()*(b-a)+a;

// ======================
// PARTICLE
// ======================
class Particle{
  constructor(x,y,tx,ty,color,type="spark",speed=1){
    this.x=x; this.y=y;
    this.tx=tx; this.ty=ty;
    this.color=color;
    this.life=0;
    this.type=type; // spark | text
    this.vx=rand(-2,2)*speed;
    this.vy=(type==="spark")?rand(-2,2)*speed:0;
    this.alpha=1;
    this.size=2;
  }
  update(){
    this.life++;
    if(this.type==="spark"){
      this.x += this.vx;
      this.y += this.vy;
      this.vy += 0.05;
      this.size *= 0.96;
      this.alpha *= 0.96;
    } else if(this.type==="text"){
      this.x += (this.tx - this.x)*0.08;
      this.y += (this.ty - this.y)*0.08;
    }
  }
  draw(ctx){
    ctx.globalAlpha = this.alpha;
    ctx.fillStyle = this.color;
    ctx.fillRect(this.x,this.y,this.size,this.size);
    ctx.globalAlpha = 1;
  }
}

let particles=[];

// ======================
// NỔ HÌNH TRÒN LỚN
// ======================
function explodeCircle(x, y){
    const count = 150; // số particle lớn
    const radius = rand(100,150); // bán kính lớn
    for(let i=0;i<count;i++){
        const angle = (i/count)*Math.PI*2;
        const vx = Math.cos(angle) * rand(radius/15,radius/10);
        const vy = Math.sin(angle) * rand(radius/15,radius/10);
        particles.push(new Particle(x,y,x+vx*10,y+vy*10,`hsl(${rand(0,360)},100%,60%)`,"spark",1));
    }
}

// ======================
// BẮN PHÁO HOA (chỉ nổ)
// ======================
function launchFireworkInstant(){
  const rocketCount = 6;
  for(let i=0;i<rocketCount;i++){
    const x = rand(W*0.1,W*0.9);
    const y = rand(H*0.2,H*0.6); // nổ ngay ở vị trí cao
    explodeCircle(x,y);
  }
}

// ======================
// CHỮ 2 HÀNG TỪ PHÁO HOA
// ======================
function createTextParticles(text,yRatio,size){
  const off = document.createElement("canvas");
  const octx = off.getContext("2d");
  off.width=W; off.height=H;
  octx.fillStyle="#fff";
  octx.textAlign="center";
  octx.textBaseline="middle";
  octx.font=`900 ${size}px Arial`;
  octx.fillText(text,W/2,H*yRatio);
  const img = octx.getImageData(0,0,W,H).data;
  for(let y=0;y<H;y+=6){
    for(let x=0;x<W;x+=6){
      const i=(y*W+x)*4;
      if(img[i+3]>150){
        particles.push(new Particle(x,H+rand(50,200),x,y,`hsl(${rand(0,360)},100%,60%)`,"text"));
      }
    }
  }
}

// ======================
// ANIMATE LOOP
// ======================
function animate(){
  ctx.fillStyle="rgba(0,0,0,0.25)";
  ctx.fillRect(0,0,W,H);
  for(let i=0;i<particles.length;i++){
    let p = particles[i];
    p.update();
    p.draw(ctx);
    if(p.life>150 && p.type!=="text") particles.splice(i--,1);
  }
  requestAnimationFrame(animate);
}
animate();

// ======================
// LẶP LẠI PHÁO HOA CHỈ NỔ
// ======================
let fireworkInterval = setInterval(launchFireworkInstant, 300);
setTimeout(()=>{ clearInterval(fireworkInterval); },15000);

// ======================
// BẮN CHỮ 2 HÀNG
// ======================
setTimeout(()=>{ createTextParticles("HAPPY NEW YEAR",0.28,W*0.08); },15000);
setTimeout(()=>{ createTextParticles("2026",0.42,W*0.2); },16500);

</script>
</body>
</html>
