<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Happy New Year 2026</title>
<style>
html, body { margin:0; padding:0; background:black; overflow:hidden; }
canvas { display:block; width:100%; height:100%; }
</style>
</head>
<body>

<canvas id="c"></canvas>

<script>
const canvas = document.getElementById("c");
const ctx = canvas.getContext("2d");

let W, H;
function resize() { W = canvas.width = window.innerWidth; H = canvas.height = window.innerHeight; }
resize();
window.addEventListener("resize", resize);

const rand = (a,b)=>Math.random()*(b-a)+a;

// ======================
// PARTICLE CHO CHỮ
// ======================
class Particle {
  constructor(x, y, tx, ty, color){
    this.x = x;
    this.y = y;
    this.tx = tx;
    this.ty = ty;
    this.vx = rand(-2,2);
    this.vy = rand(-12,-9);
    this.color = color;
    this.life = 0;
  }
  update(){
    this.life++;
    if(this.life < 30){
      this.y += this.vy;
      this.x += this.vx;
    } else {
      this.x += (this.tx - this.x)*0.08;
      this.y += (this.ty - this.y)*0.08;
    }
  }
  draw(ctx){
    ctx.fillStyle = this.color;
    ctx.fillRect(this.x, this.y, 2, 2);
  }
}

// ======================
// PHÁO HOA BAN ĐẦU DÀY ĐẶC
// ======================
let fireworks = [];
function launchInitialFireworks(){
  for(let i=0;i<6;i++){
    const x = rand(W*0.1,W*0.9);
    const y = H+50;
    const peakY = rand(H*0.2,H*0.6);
    fireworks.push({x,y,vy:rand(-7,-10),peakY,type:"circle"});
  }
}

// ======================
// TẠO PARTICLE CHO CHỮ
// ======================
function createTextParticles(text, yRatio, size){
  const off = document.createElement("canvas");
  const octx = off.getContext("2d");
  off.width = W; off.height = H;

  octx.fillStyle = "#fff";
  octx.textAlign = "center";
  octx.textBaseline = "middle";
  octx.font = `900 ${size}px Arial`;
  octx.fillText(text,W/2,H*yRatio);

  const img = octx.getImageData(0,0,W,H).data;
  for(let y=0;y<H;y+=6){
    for(let x=0;x<W;x+=6){
      const i = (y*W+x)*4;
      if(img[i+3]>150){
        fireworks.push(new Particle(x,H+rand(50,200),x,y,`hsl(${rand(0,360)},100%,60%)`));
      }
    }
  }
}

// ======================
// ANIMATE LOOP
// ======================
function animate(){
  ctx.fillStyle = "rgba(0,0,0,0.25)";
  ctx.fillRect(0,0,W,H);

  for(let i=0;i<fireworks.length;i++){
    const p = fireworks[i];
    if(p.vy!==undefined){ // rocket ban đầu
      p.y += p.vy;
      p.vy += 0.15;
      if(p.y<=p.peakY){
        // nổ ra nhiều particle xung quanh
        const count = 60 + Math.floor(rand(0,20));
        for(let j=0;j<count;j++){
          const angle = (j/count)*Math.PI*2;
          const vx = Math.cos(angle)*rand(2,6);
          const vy = Math.sin(angle)*rand(2,6);
          fireworks.push(new Particle(p.x,p.y,p.x+vx,p.y+vy,`hsl(${rand(0,360)},100%,60%)`));
        }
        fireworks.splice(i,1);
        i--;
      }
    } else {
      p.update();
      p.draw(ctx);
    }
  }

  requestAnimationFrame(animate);
}
animate();

// ======================
// PHÁO HOA BAN ĐẦU
// ======================
let initialInterval = setInterval(launchInitialFireworks, 300);
setTimeout(()=>{ clearInterval(initialInterval); },15000);

// ======================
// BẮN CHỮ 2 HÀNG
// ======================
setTimeout(()=>{ createTextParticles("HAPPY NEW YEAR",0.28,W*0.08); },15000);
setTimeout(()=>{ createTextParticles("2026",0.42,W*0.2); },16500);

</script>

</body>
</html>
